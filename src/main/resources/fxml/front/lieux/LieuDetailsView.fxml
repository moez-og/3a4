<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<VBox xmlns="http://javafx.com/javafx/21"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="controllers.front.lieux.LieuDetailsController"
      spacing="0"
      styleClass="lieuDetailsRoot"
      stylesheets="@/styles/lieux/lieux-details.css,@/styles/lieux/share-dialog.css">

    <padding>
        <Insets top="14" right="16" bottom="18" left="16"/>
    </padding>

    <!-- â•â• TOP BAR â•â• -->
    <HBox alignment="CENTER_LEFT" spacing="10" styleClass="topBar">
        <Button text="â† Retour" onAction="#goBack" styleClass="backLinkBtn"/>
        <Label fx:id="breadcrumb" text="" styleClass="breadcrumbLabel"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Button fx:id="favoriBtn" text="â™¡  Favoris" onAction="#toggleFavori" styleClass="favoriBtn"/>
        <Button text="â¤´  Partager" onAction="#openShare" styleClass="shareBtn"/>
        <Button text="ðŸ—º  Maps" onAction="#openMaps" styleClass="primaryBtn"/>
    </HBox>

    <!-- â•â• MAIN SCROLL â•â• -->
    <ScrollPane fitToWidth="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED"
                styleClass="detailsScroll" VBox.vgrow="ALWAYS">
        <content>
            <VBox spacing="16">
                <padding><Insets top="14" bottom="14"/></padding>

                <!-- â•â• TITRE + BADGES (pleine largeur) â•â• -->
                <VBox spacing="8" styleClass="detailsCard">
                    <HBox alignment="CENTER_LEFT" spacing="12">
                        <Label fx:id="name" text="Nom du lieu" styleClass="detailsTitle"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="badgeOuvert" text="â— OUVERT" styleClass="badgeOuvert" visible="false" managed="false"/>
                        <Label fx:id="badgeFerme"  text="â— FERMÃ‰"  styleClass="badgeFerme"  visible="false" managed="false"/>
                    </HBox>
                    <HBox spacing="8" alignment="CENTER_LEFT">
                        <Label fx:id="categorie" text="" styleClass="badge"/>
                        <Label fx:id="type"      text="" styleClass="badgeMuted"/>
                        <Label fx:id="budgetBadge" text="" styleClass="budgetBadge"/>
                    </HBox>
                </VBox>

                <!-- â•â• DEUX COLONNES : galerie gauche | infos droite â•â• -->
                <HBox fx:id="twoColLayout" spacing="16" alignment="TOP_LEFT">

                    <!-- â”€â”€ COLONNE GAUCHE : galerie â”€â”€ -->
                    <VBox fx:id="galerieColBox" spacing="10" HBox.hgrow="ALWAYS" styleClass="galerieCol">

                        <!-- Galerie avec flÃ¨ches -->
                        <StackPane fx:id="galeriePane" styleClass="galerieWrap">
                            <ImageView fx:id="image"
                                       fitWidth="640" fitHeight="400"
                                       preserveRatio="false"
                                       styleClass="detailsHeroImg"/>
                            <!-- FlÃ¨che gauche -->
                            <Button fx:id="prevBtn" text="â€¹" onAction="#prevImage"
                                    styleClass="galleryNavBtn galleryNavLeft"
                                    StackPane.alignment="CENTER_LEFT"/>
                            <!-- FlÃ¨che droite -->
                            <Button fx:id="nextBtn" text="â€º" onAction="#nextImage"
                                    styleClass="galleryNavBtn galleryNavRight"
                                    StackPane.alignment="CENTER_RIGHT"/>
                            <!-- Compteur -->
                            <Label fx:id="imageCounter" text="1 / 1"
                                   styleClass="imageCounter"
                                   StackPane.alignment="TOP_LEFT"/>
                        </StackPane>

                        <!-- Miniatures -->
                        <ScrollPane hbarPolicy="AS_NEEDED" vbarPolicy="NEVER"
                                    fitToHeight="true" styleClass="thumbScroll">
                            <content>
                                <HBox fx:id="thumbsRow" spacing="8" styleClass="thumbsRow"/>
                            </content>
                        </ScrollPane>

                        <!-- Description -->
                        <VBox fx:id="descriptionCard" spacing="8" styleClass="detailsCard">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="|" styleClass="sectionAccent"/>
                                <Label text="Ã€ propos" styleClass="detailsSectionTitle"/>
                            </HBox>
                            <Label fx:id="description" text="" wrapText="true" styleClass="detailsDesc"/>
                        </VBox>

                        <!-- Horaires -->
                        <VBox fx:id="horaireCard" spacing="10" styleClass="detailsCard">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="|" styleClass="sectionAccent"/>
                                <Label text="ðŸ•  Horaires d'ouverture" styleClass="detailsSectionTitle"/>
                            </HBox>
                            <VBox fx:id="horairesList" spacing="4"/>
                            <Label fx:id="horairesEmpty" text="Aucun horaire renseignÃ©."
                                   styleClass="detailsHint" visible="false" managed="false"/>
                        </VBox>

                    </VBox>

                    <!-- â”€â”€ COLONNE DROITE : infos â”€â”€ -->
                    <VBox fx:id="infoColBox" spacing="12" styleClass="infoCol">

                        <!-- Statut ouverture (bandeau jaune) -->
                        <HBox fx:id="statutBannerBox" styleClass="statutBanner" visible="false" managed="false">
                            <Label fx:id="statutBannerLabel" text="" styleClass="statutBannerTxt" wrapText="true" HBox.hgrow="ALWAYS"/>
                        </HBox>

                        <!-- Budget -->
                        <VBox fx:id="budgetCard" spacing="6" styleClass="infoBlock">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="|" styleClass="sectionAccent"/>
                                <Label text="ðŸ’°  Budget moyen" styleClass="detailsSectionTitle"/>
                            </HBox>
                            <Label fx:id="budget" text="" styleClass="infoValue"/>
                        </VBox>

                        <!-- Adresse -->
                        <VBox spacing="6" styleClass="infoBlock">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="|" styleClass="sectionAccent"/>
                                <Label text="ðŸ“  Adresse" styleClass="detailsSectionTitle"/>
                            </HBox>
                            <Label fx:id="adresse" text="" styleClass="infoValue" wrapText="true"/>
                            <Label fx:id="ville"   text="" styleClass="detailsHint"/>
                            <Label fx:id="coords"  text="" styleClass="detailsHint"/>
                        </VBox>

                        <!-- Contact -->
                        <VBox fx:id="contactCard" spacing="8" styleClass="infoBlock">
                            <HBox alignment="CENTER_LEFT" spacing="8">
                                <Label text="|" styleClass="sectionAccent"/>
                                <Label text="ðŸ“ž  Contact" styleClass="detailsSectionTitle"/>
                            </HBox>
                            <Label fx:id="telephone" text="" styleClass="infoValue" visible="false" managed="false"/>
                            <Button fx:id="siteWebBtn"   text="" onAction="#openSiteWeb"   styleClass="linkBtn"      visible="false" managed="false"/>
                            <Button fx:id="instagramBtn" text="" onAction="#openInstagram" styleClass="instagramBtn" visible="false" managed="false"/>
                        </VBox>

                        <!-- â”€â”€ Bloc Actions â”€â”€ -->
                        <VBox fx:id="actionsBlock" spacing="12" styleClass="infoBlock actionsBlock">

                            <!-- Ligne : Offres (privÃ©) + Ajouter sortie -->
                            <HBox fx:id="actionsRow2" spacing="8" alignment="CENTER_LEFT">
                                <Button fx:id="offresBtn"
                                        text="ðŸ·  Voir les offres"
                                        onAction="#openOffres"
                                        styleClass="actionBtnOffres"
                                        visible="false" managed="false"
                                        HBox.hgrow="ALWAYS"
                                        maxWidth="Infinity"/>
                                <Button fx:id="sortieBtn"
                                        text="ï¼‹  Ajouter une sortie"
                                        onAction="#openSortieCreate"
                                        styleClass="actionBtnSortie"
                                        HBox.hgrow="ALWAYS"
                                        maxWidth="Infinity"/>
                            </HBox>

                        </VBox>

                        <!-- â”€â”€ Formulaire Sortie Inline (cachÃ© par dÃ©faut) â”€â”€ -->
                        <VBox fx:id="inlineSortieContainer" spacing="0" visible="false" managed="false"/>

                    </VBox>
                </HBox>

                <!-- â•â• AVIS (pleine largeur) â•â• -->
                <VBox spacing="12" styleClass="avisCard">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <HBox alignment="CENTER_LEFT" spacing="8">
                            <Label text="|" styleClass="sectionAccent"/>
                            <Label fx:id="avisTitle" text="Avis des visiteurs / 0" styleClass="avisTitle"/>
                        </HBox>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label fx:id="avisAvg" text="â€”" styleClass="avisAvg"/>
                        <Button text="+ Ajouter un avis" onAction="#openAddAvis" styleClass="primaryBtn"/>
                    </HBox>
                    <TextField fx:id="avisSearchField" promptText="Rechercher dans les avisâ€¦" styleClass="avisSearch"/>
                    <Label fx:id="avisEmpty" text="Aucun avis pour le moment."
                           styleClass="detailsHint" visible="false" managed="false"/>
                    <VBox fx:id="avisList" spacing="10"/>
                </VBox>

            </VBox>
        </content>
    </ScrollPane>
</VBox>
