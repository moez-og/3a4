<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Priority?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1" fx:controller="controllers.back.offres.AdminOffreController" styleClass="offres-admin-root" stylesheets="@/styles/offres/offres-back.css">
    <padding>
        <Insets top="18" right="18" bottom="18" left="18" />
    </padding>

    <top>
        <VBox spacing="8" styleClass="panel-card">
            <HBox alignment="CENTER_LEFT" spacing="10">
                <Label text="Gestion des Offres" styleClass="offres-title" />
                <Label text="ADMIN" styleClass="badge-chip" />
            </HBox>
            <Label text="Gestion Offres + Codes promo générés" styleClass="offres-subtitle" />
            <HBox spacing="8" alignment="CENTER_LEFT">
                <Button fx:id="btnModeOffres" text="Afficher Offres" onAction="#onShowOffresMode" styleClass="mode-btn" />
                <Button fx:id="btnModeCodes" text="Afficher Codes Promo" onAction="#onShowCodesMode" styleClass="mode-btn" />
            </HBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED" styleClass="offres-scroll" BorderPane.alignment="CENTER">
            <content>
                <VBox spacing="12" styleClass="offres-content-wrap">
                    <StackPane>
                        <VBox fx:id="sectionOffres" spacing="12">
                            <VBox spacing="10" styleClass="panel-card">
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label text="Liste des offres" styleClass="section-title" />
                                </HBox>
                                <TableView fx:id="tableOffres" prefHeight="300.0" minHeight="220.0" styleClass="offres-table">
                                    <columns>
                                        <TableColumn fx:id="colId" prefWidth="60.0" text="ID" />
                                        <TableColumn fx:id="colLieu" prefWidth="140.0" text="Lieu" />
                                        <TableColumn fx:id="colTitre" prefWidth="180.0" text="Titre" />
                                        <TableColumn fx:id="colType" prefWidth="120.0" text="Type" />
                                        <TableColumn fx:id="colPourcentage" prefWidth="110.0" text="Pourcentage" />
                                        <TableColumn fx:id="colDateDebut" prefWidth="110.0" text="Date Début" />
                                        <TableColumn fx:id="colDateFin" prefWidth="110.0" text="Date Fin" />
                                        <TableColumn fx:id="colStatut" prefWidth="110.0" text="Statut" />
                                    </columns>
                                </TableView>
                                <VBox.vgrow>
                                    <Priority fx:constant="ALWAYS" />
                                </VBox.vgrow>
                            </VBox>

                            <VBox spacing="10" styleClass="panel-card">
                                <Label text="Formulaire Offre" styleClass="section-title" />
                                <Separator />

                                <GridPane hgap="12" vgap="10" styleClass="offres-form-grid">
                                    <columnConstraints>
                                        <ColumnConstraints halignment="RIGHT" minWidth="90" prefWidth="120" />
                                        <ColumnConstraints hgrow="ALWAYS" />
                                        <ColumnConstraints halignment="RIGHT" minWidth="90" prefWidth="120" />
                                        <ColumnConstraints hgrow="ALWAYS" />
                                    </columnConstraints>

                                    <Label text="Lieu" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                    <ComboBox fx:id="cbLieu" prefWidth="220" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                                    <Label text="Statut" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                                    <ComboBox fx:id="cbStatut" prefWidth="180" GridPane.columnIndex="3" GridPane.rowIndex="0" />

                                    <Label text="Titre" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                    <TextField fx:id="tfTitre" promptText="Titre de l'offre" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                    <Label text="Type" GridPane.columnIndex="2" GridPane.rowIndex="1" />
                                    <TextField fx:id="tfType" promptText="Ex: Happy Hour" GridPane.columnIndex="3" GridPane.rowIndex="1" />

                                    <Label text="Pourcentage" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                                    <TextField fx:id="tfPourcentage" promptText="Ex: 20" GridPane.columnIndex="1" GridPane.rowIndex="2" />

                                    <Label text="Date début" GridPane.columnIndex="2" GridPane.rowIndex="2" />
                                    <DatePicker fx:id="dpDateDebut" GridPane.columnIndex="3" GridPane.rowIndex="2" />

                                    <Label text="Date fin" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                                    <DatePicker fx:id="dpDateFin" GridPane.columnIndex="1" GridPane.rowIndex="3" />

                                    <Label text="Description" GridPane.columnIndex="0" GridPane.rowIndex="4" />
                                    <TextArea fx:id="taDescription" prefRowCount="3" promptText="Description de l'offre" GridPane.columnIndex="1" GridPane.columnSpan="3" GridPane.rowIndex="4" />

                                    <HBox spacing="10" alignment="CENTER_RIGHT" GridPane.columnIndex="0" GridPane.columnSpan="4" GridPane.rowIndex="5">
                                        <Button text="Ajouter" onAction="#onAjouter" styleClass="btn-add" />
                                        <Button text="Modifier" onAction="#onModifier" styleClass="btn-edit" />
                                        <Button text="Supprimer" onAction="#onSupprimer" styleClass="btn-delete" />
                                        <Button text="Réinitialiser" onAction="#onReset" styleClass="btn-reset" />
                                    </HBox>
                                </GridPane>
                            </VBox>
                        </VBox>

                        <VBox fx:id="sectionCodes" spacing="12" visible="false" managed="false">
                            <VBox spacing="10" styleClass="panel-card">
                                <HBox alignment="CENTER_LEFT" spacing="8">
                                    <Label text="Codes promo générés" styleClass="section-title" />
                                </HBox>
                                <TableView fx:id="tableCodesPromo" prefHeight="300.0" minHeight="220.0" styleClass="offres-table">
                                    <columns>
                                        <TableColumn fx:id="colPromoId" prefWidth="65" text="ID" />
                                        <TableColumn fx:id="colPromoOffre" prefWidth="90" text="Offre" />
                                        <TableColumn fx:id="colPromoUser" prefWidth="120" text="Utilisateur" />
                                        <TableColumn fx:id="colPromoDateGen" prefWidth="120" text="Date Gén." />
                                        <TableColumn fx:id="colPromoDateExp" prefWidth="120" text="Date Exp." />
                                        <TableColumn fx:id="colPromoStatut" prefWidth="110" text="Statut" />
                                        <TableColumn fx:id="colPromoQr" prefWidth="260" text="QR URL" />
                                    </columns>
                                </TableView>
                            </VBox>

                            <VBox spacing="10" styleClass="panel-card">
                                <Label text="Formulaire Code Promo (Modification/Suppression)" styleClass="section-title" />
                                <Separator />

                                <GridPane hgap="12" vgap="10" styleClass="offres-form-grid">
                                    <columnConstraints>
                                        <ColumnConstraints halignment="RIGHT" minWidth="90" prefWidth="120" />
                                        <ColumnConstraints hgrow="ALWAYS" />
                                        <ColumnConstraints halignment="RIGHT" minWidth="90" prefWidth="120" />
                                        <ColumnConstraints hgrow="ALWAYS" />
                                    </columnConstraints>

                                    <Label text="ID" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                    <TextField fx:id="tfPromoId" editable="false" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                                    <Label text="Offre ID" GridPane.columnIndex="2" GridPane.rowIndex="0" />
                                    <TextField fx:id="tfPromoOffreId" GridPane.columnIndex="3" GridPane.rowIndex="0" />

                                    <Label text="User ID" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                    <TextField fx:id="tfPromoUserId" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                                    <Label text="Statut" GridPane.columnIndex="2" GridPane.rowIndex="1" />
                                    <ComboBox fx:id="cbPromoStatut" GridPane.columnIndex="3" GridPane.rowIndex="1" />

                                    <Label text="Date Gén." GridPane.columnIndex="0" GridPane.rowIndex="2" />
                                    <DatePicker fx:id="dpPromoDateGen" GridPane.columnIndex="1" GridPane.rowIndex="2" />

                                    <Label text="Date Exp." GridPane.columnIndex="2" GridPane.rowIndex="2" />
                                    <DatePicker fx:id="dpPromoDateExp" GridPane.columnIndex="3" GridPane.rowIndex="2" />

                                    <Label text="QR URL" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                                    <TextField fx:id="tfPromoQr" GridPane.columnIndex="1" GridPane.columnSpan="3" GridPane.rowIndex="3" />

                                    <HBox spacing="10" alignment="CENTER_RIGHT" GridPane.columnIndex="0" GridPane.columnSpan="4" GridPane.rowIndex="4">
                                        <Button text="Modifier" onAction="#onModifierCodePromo" styleClass="btn-edit" />
                                        <Button text="Supprimer" onAction="#onSupprimerCodePromo" styleClass="btn-delete" />
                                        <Button text="Réinitialiser" onAction="#onResetCodePromo" styleClass="btn-reset" />
                                    </HBox>
                                </GridPane>
                            </VBox>
                        </VBox>
                    </StackPane>
                </VBox>
            </content>
        </ScrollPane>
    </center>
</BorderPane>
